#!/usr/bin/env bqn
NumDigitsâ€¿Dividersâ€¿AllEqualâ€¿Partitionâ€¿Whileâ€¿DoWhileâ€¿If â† â€¢Import "../base_structures/utils.bqn"


CompareTwoParts â† {
  half_decimal â† 10â‹†(âŒŠ(NumDigits ğ•©)Ã·2)
  first_part â† half_decimal|ğ•©
  second_part â† âŒŠğ•©Ã·half_decimal
  first_part=second_part
}

HasRepeatedDigits â† {
  n â† ğ•©
  num_digits â† NumDigits n
  return â† 0

  If (num_digits>1)â€¿{ğ•¤
    v_dividers â† Dividers num_digits

    # Because of the performance too...
    i â† 0
    DoWhile âŸ¨{ğ•¤â‹„i<â‰ v_dividers}, {ğ•¤â‹„i+â†©1}{ğ”¾âˆ˜ğ”½}{ğ•¤
      divider â† (i-1)âŠ‘v_dividers
      num_parts â† num_digits Ã· divider
      parts â† {(10â‹†divider)|âŒŠnÃ·10â‹†(dividerÃ—ğ•©)}Â¨â†•num_parts
 
      If (AllEqual parts)â€¿{ğ•¤
        return â†© 1
      }
    }âŸ©
  }
  return
}

SumRepeatedNumbers â† {
  v â† â€¢ParseFloatÂ¨'-' Partition ğ•©
  # Because of the performance...
  fn â† ğ•¨
  sumâ†0
  iâ†âŠ‘v-1
  While âŸ¨{ğ•¤â‹„iâ‰¤1âŠ‘v}, {ğ•¤â‹„i+â†©1}{ğ”¾âˆ˜ğ”½}{ğ•¤
    If (Fn i)â€¿{ğ•¤
      sum +â†© i
    }
  }âŸ©
  sum
}

input â† âŠ‘â€¢FLines"input"
input â†© ',' Partition input

# Part 1
â€¢Show +Â´{comparetwoparts SumRepeatedNumbers ğ•©}Â¨input
# Part 2
â€¢Show +Â´{hasrepeateddigits SumRepeatedNumbers ğ•©}Â¨input
